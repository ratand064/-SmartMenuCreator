<ion-header class="ion-no-border">
  <ion-toolbar class="custom-toolbar">
    <ion-buttons slot="start">
      <ion-button (click)="handleProfileClick()" class="profile-btn">
        <ion-icon 
          [name]="isLoggedIn ? 'person-circle' : 'person-circle-outline'" 
          [color]="isAdminMode ? 'warning' : 'medium'">
        </ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="main-title">
      {{ isAdminMode ? 'Admin' : 'Our' }} <span>Menu</span>
    </ion-title>
    <ion-buttons slot="end">
      <div class="coin-chip" (click)="showRewardInfo()">
        <ion-icon name="sparkles"></ion-icon>
        <span>250</span>
      </div>
    </ion-buttons>
  </ion-toolbar>
  <ion-toolbar class="search-toolbar">
    <div class="search-filter-container">
      <ion-searchbar 
        class="custom-search"
        placeholder="Search for dishes..." 
        search-icon="search"
        (ionInput)="filterItems($event)">
      </ion-searchbar>
      <ion-button 
        class="filter-btn" 
        fill="clear"
        (click)="toggleFilterModal()">
        <ion-icon 
          name="funnel-outline" 
          [color]="selectedCategory !== 'all' || selectedPriceRange !== 'all' ? 'primary' : 'medium'">
        </ion-icon>
      </ion-button>
    </div>
  </ion-toolbar>
  <div class="filter-dropdown" *ngIf="showFilterModal">
    <div class="filter-backdrop" (click)="toggleFilterModal()"></div>
    <div class="filter-content">
      <div class="filter-header">
        <h3>Filters</h3>
        <ion-button fill="clear" size="small" (click)="toggleFilterModal()">
          <ion-icon name="close"></ion-icon>
        </ion-button>
      </div>
      
      <!-- Category Filter Section -->
      <div class="filter-section">
        <div class="filter-section-title">Category</div>
        <div class="filter-options">
          <div 
            *ngFor="let cat of categories" 
            class="filter-option"
            [class.selected]="selectedCategory === cat.value"
            (click)="selectCategory(cat.value)">
            <ion-icon [name]="cat.icon"></ion-icon>
            <span>{{ cat.label }}</span>
            <ion-icon 
              *ngIf="selectedCategory === cat.value" 
              name="checkmark-circle" 
              class="check-icon">
            </ion-icon>
          </div>
        </div>
      </div>

      <!-- Price Filter Section -->
      <div class="filter-section">
        <div class="filter-section-title">Price Range</div>
        <div class="filter-options">
          <div 
            *ngFor="let range of priceRanges" 
            class="filter-option"
            [class.selected]="selectedPriceRange === range.value"
            (click)="selectPriceRange(range.value)">
            <ion-icon [name]="range.icon"></ion-icon>
            <span>{{ range.label }}</span>
            <ion-icon 
              *ngIf="selectedPriceRange === range.value" 
              name="checkmark-circle" 
              class="check-icon">
            </ion-icon>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-header>
<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="loadMenu($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <div *ngIf="loading" class="ion-padding-top">
    <app-skeleton-loader view="menu"></app-skeleton-loader>
  </div>
  <ion-grid *ngIf="!loading" class="ion-no-padding menu-grid">
    <ion-row>
      <ion-col size="6" size-md="4" size-lg="3" *ngFor="let item of filteredItems">
        <div class="food-card fade-in">
         <div class="image-wrapper">
  <ion-img 
    [src]="item.imageUrl || 'assets/placeholder.png'" 
    (ionError)="handleImageError($event)"
    [alt]="item.title">
  </ion-img>
  
  <div class="price-badge">â‚¹{{ item.price }}</div>
</div>
          <div class="card-content-area">
            <div class="food-title">{{ item.title }}</div>
            <div class="food-desc">{{ item.description }}</div>
            <div class="action-row">
              <ng-container *ngIf="!isAdminMode">
                <ion-button class="action-btn add-btn" (click)="addToCart(item)">
                  ADD <ion-icon name="add" slot="end"></ion-icon>
                </ion-button>
                <ion-button fill="clear" class="icon-btn share-btn" (click)="shareItem(item)">
                  <ion-icon name="logo-whatsapp" slot="icon-only"></ion-icon>
                </ion-button>
              </ng-container>
              <ng-container *ngIf="isAdminMode">
                <ion-button fill="clear" class="icon-btn edit-btn" (click)="editItem(item)">
                  <ion-icon name="create" slot="icon-only"></ion-icon>
                </ion-button>
                <ion-button fill="clear" class="icon-btn delete-btn" (click)="deleteItem(item)">
                  <ion-icon name="trash" slot="icon-only"></ion-icon>
                </ion-button>
              </ng-container>
            </div>
          </div>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
  <div *ngIf="!loading && filteredItems.length === 0" class="empty-state">
    <div class="empty-icon-wrapper">
      <ion-icon name="search"></ion-icon>
    </div>
    <h3>No dishes found</h3>
    <p>Try adjusting your filters!</p>
  </div>
  <div class="spacer"></div>
</ion-content>